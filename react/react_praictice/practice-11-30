

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <title>Document</title>
</head>

<body>
    <div id="root"></div>
    <script type="text/babel">

      
        // API í‚¤ ì„¤ì •í•˜ê¸°


                    const weatherIcons = {
                Clear: 'â˜€ï¸',
                Clouds: 'â˜ï¸',
                Rain: 'ğŸŒ§ï¸',
                Snow: 'â„ï¸',
                Mist: 'ğŸŒ«ï¸',
                Drizzle: 'ğŸŒ¦ï¸',
                Thunderstorm: 'â›ˆï¸'
            };

        
        const { useEffect, useState } = React;
        // useEffect, useState hookê°€ì ¸ì˜¤ê¸°
        // !!!---'user'ê°€ ì•„ë‹ˆë¼ 'use'ì„ ê·¸ë§Œ ì˜ëª»ì“°ê¸°---!!!!


        function Weather() {
            //í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ ì„ ì–¸

            const [position, setPosition] = useState({});
            const [cityName, setCityName] = useState('');
            const [weather, setWeather] = useState({});
            const [wind, setWind] = useState({});
            const [imgUrl, setImgUrl] = useState('');
            const [imgName, setImgName] = useState('');
            const weatherIcons = {
                Clear: 'sunny',
                Clouds: 'cloud',
                Rain: 'droplet',
                Snow: 'snowman',
                Mist: 'foggy',
                Drizzle: 'umbrella',
                Thunderstorm: 'zap'
                // ì•„ì´ì½˜ ì´ë¦„ì´ ì—†ëŠ”ê²Œ ìˆì–´ì„œ ì„ì˜ë¡œ ì‘ì„±
            };
            // ë‚ ì”¨ì™€ ì´ëª¨í‹°ì½˜ì— í•„ìš”í•œ ê°ì²´ ì •ì˜
            // í•„ìš”í•œ ê°ì²´ë¥¼ ë¯¸ë¦¬ ì •ë¦¬í•˜ê³  apië¥¼ ê°€ì ¸ì˜¤ë“  apië¥¼ ì—°ê²°í•˜ê³  í•„ìš”í•œ ê°ì²´ë¥¼ ì„ ì–¸í•˜ë“  ìê¸°ë§ˆìŒì„


            useEffect(
                //ë§ˆìš´íŠ¸ ì‹œì— ì‹¤í–‰
                () => {
                    new Promise((resolve, reject) => {
                        // ë¹„ë™ê¸° ì‘ì—…ì„ ìˆœì°¨ì ìœ¼ë¡œ í•˜ê³ ì‹¶ì„ë•Œ Promiseì‚¬ìš©

                        navigator.geolocation.getCurrentPosition(currentPosition => {

                            setPosition({
                                longitude: currentPosition.coords.longitude,
                                latitude: currentPosition.coords.latitude
                            })

                            resolve(currentPosition.coords);
                            // resolveëŠ” Promiseê°€ ì„±ê³µ í–ˆì„ë•Œ rejectëŠ” ì‹¤íŒ¨í–ˆì„ë•Œ ì˜¤ë¥˜ë¥¼ ì¡ìœ¼ë ¤ê³  ì‚¬ìš©
                            console.log(currentPosition.coords)
                        });
                    }).then(coords => {

                        fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${coords.latitude}&lon=${coords.longitude}&appid=${API_KEY}`)
                        // ë„¤íŠ¸ì›ŒíŠ¸ì— ìš”ì²­ ë³´ë‚´ê¸°
                            .then(response => response.json())
                            .then(json => {
                                setCityName(json.name);
                                console.log(json.weather)
                                setWeather(json.weather[0]);
                                setWind(json.wind);
                                // setImgUrl(json.weather[0].main)
                                // console.log(json.weather[0].main)
                                // setImgName(json.weather[0].main)

                                // axios.get('https://api.github.com/emojis')
                                //     .then(res => {
                                //         setImgUrl(res.data[imgName])
                                //         console.log(res.data)

                                const imgIcon = json.weather[0].main;
                                // í˜„ì¬ ë‚ ì”¨ì˜ ì´ë¦„
                                const iconName = weatherIcons[imgIcon] || 'question';
                                // ë‚ ì”¨ ì•„ì´ì½˜ì´ ì—†ìœ¼ë©´ ë¬¼ìŒí‘œ ì´ëª¨í‹°ì½˜ ë‚˜ì˜¤ê²Œ

                                console.log("iconName")
                                console.log(iconName)
                                axios.get('https://api.github.com/emojis')
                                    .then(res => {
                                        setImgUrl(res.data[iconName]);
                                        //apiì¤‘ì— í˜„ì¬ ë‚ ì”¨ì˜ ì´ë¦„ì„ ê°€ì§€ê³  ìˆëŠ” ì•„ì´ì½˜ì„ urlë¡œ ì„¤ì •

                                    });
                            });

                            //ì‘ë‹µ ì²˜ë¦¬
                    });
                },
                [] //ì²« ë§ˆìš´íŠ¸ ì‹œì—ë§Œ ì‘ë™í•˜ë„ë¡ ë¹ˆë°°ì—´ ì„¤ì •
            );

            return (
                <>
                    <h3>í˜„ì¬ ìœ„ì¹˜</h3>
                    <h4>{`ê²½ë„ : ${position.latitude} ìœ„ë„ : ${position.longitude}`}</h4>
                    <h4>{`ì¡°íšŒë„ì‹œ : ${cityName}`}</h4>
                    <h4>{`ë‚ ì”¨ : ${weather.main} ë‚ ì”¨ ì„¤ëª… : ${weather.description}`}</h4>
                    <h4>{`í’í–¥ : ${wind.deg}ë„ í’ì† : ${wind.speed}m/s`}</h4>
                    <img src={imgUrl} />
                </>
            )
            //Appì— ë“¤ê³ ê°ˆ ë¦¬í„´ ê°’
        }


        function App() {

            return (
                <>
                    <h1>ì˜¤ëŠ˜ì˜ ë‚ ì”¨</h1>
                    <Weather />
                    <br/>
                </>
            );
            // í™”ë©´ì— ì‹¤ì œë¡œ ë³´ì—¬ì§ˆ ë¶€ë¶„
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
        // Appì„ rootì— ì¶”ê°€
    </script>
</body>

</html>
